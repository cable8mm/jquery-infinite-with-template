!function(e){e.fn.infiniteTemplate=function(t){var n=e(this);if(!n.length)return n;var l=e.extend({},e.fn.infiniteTemplate.defaults,t),a=l.initialPage,o=!1;l.loadSelector?e(document).on("click",l.loadSelector,function(){r()}):e(window).on("scroll",function(){e(this).scrollTop()>e(document.body).height()-2*e(this).height()&&r()});var i=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()};function r(){if(!o){o=!0;var t=e.templates(l.templateSelector),r=l.query?"&"+l.query:"";e.ajax({url:l.dataPath+"?page="+a+r,method:l.method,success:function(r){console.log(i(r)),"string"==typeof r&&(r=JSON.parse(r)),r&&(e.each(r.data,function(a,o){l.templateHelpers&&(o=Object.assign(o,l.templateHelpers));var i=t.render(o);e(i).appendTo(n)}),a+=1),o=!1}})}}return l.loadAtStart&&r(),this},e.fn.infiniteTemplate.defaults={dataPath:null,templateSelector:null,query:null,method:"GET",templateHelpers:null,loadAtStart:!0,loadSelector:null,initialPage:1}}(jQuery);