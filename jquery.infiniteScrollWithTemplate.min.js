!function(e){e.fn.infiniteTemplate=function(t){var n=e(this);if(!n.length)return n;var l=e.extend({},e.fn.infiniteTemplate.defaults,t),a=0,o=!1;l.loadSelector?e(document).on("click",l.loadSelector,function(){i()}):e(window).on("scroll",function(){e(this).scrollTop()>e(document.body).height()-2*e(this).height()&&i()});var r=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()};function i(){if(!o){o=!0;var t=e.templates(l.templateSelector),i=l.query?"&"+l.query:"";e.ajax({url:l.dataPath+"?page="+a+i,method:l.method,success:function(i){console.log(r(i)),"string"==typeof i&&(i=JSON.parse(i)),i&&(e.each(i.data,function(a,o){l.templateHelpers&&(o=Object.assign(o,l.templateHelpers));var r=t.render(o);e(r).appendTo(n)}),a+=1),o=!1}})}}return l.loadAtStart&&i(),this},e.fn.infiniteTemplate.defaults={dataPath:null,templateSelector:null,query:null,method:"GET",templateHelpers:null,loadAtStart:!0,loadSelector:null}}(jQuery);