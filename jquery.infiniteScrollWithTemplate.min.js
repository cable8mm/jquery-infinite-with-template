!function(e){e.fn.infiniteTemplate=function(t){var n=e(this);if(!n.length)return n;var a=e.extend({},e.fn.infiniteTemplate.defaults,t),l=a.initialPage,i=!1,o=!1;function r(){if(!i&&!o){i=!0;var t=e.templates(a.templateSelector),r=a.query?"&"+a.query:"",c=a.preventCache?"&t="+(new Date).getTime():"";e.ajax({url:a.dataPath+"?page="+l+r+c,method:a.method,success:function(r){"string"==typeof r&&(r=JSON.parse(r)),r&&(0==r.data.length?o=!0:(e.each(r.data,function(l,i){a.templateHelpers&&(i=Object.assign(i,a.templateHelpers));var o=t.render(i);e(o).appendTo(n)}),l+=1)),i=!1}})}}return a.loadSelector?e(document).on("click",a.loadSelector,function(){r()}):e(window).on("scroll",function(){e(this).scrollTop()>e(document.body).height()-2*e(this).height()&&!o&&r()}),a.loadAtStart&&r(),this},e.fn.infiniteTemplate.defaults={dataPath:null,templateSelector:null,query:null,method:"GET",templateHelpers:null,loadAtStart:!0,loadSelector:null,initialPage:1,preventCache:!1}}(jQuery);